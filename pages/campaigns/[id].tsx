import type { NextPage } from 'next'
import {useState} from "react"
import Head from 'next/head'
import { useRouter } from "next/router";
import {useEffect} from "react"
import Axios from 'axios'
import CampaignMenu from '../../components/CampaignMenu';
import CampaignDetailCards from '../../components/CampaignDetailCards';
import DirectorAgeChart from '../../components/DirectorAgeChart';
import CompanyLocationChart from '../../components/CompanyLocationChart';
import CampaignCostChart from "../../components/CampaignCostChart"




const Campaign: NextPage = () => {
  const router = useRouter();
  const { id } = router.query;
  const [campaign, setCampaign] = useState(null);

  
  

  useEffect(() => {
    async function getCampaign() {
      const data = await Axios.post(`/api/campaigns/get`, {
        campaign_name: id
      });
     
      setCampaign(data.data);
    }
    getCampaign();
  }, []);

  return (
    <div className='p-8 max-w-7xl mx-auto' style={{minHeight: "100vh"}}>
      <Head>
        <title>Ember | SSGM</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <CampaignMenu setCampaign={setCampaign} campaign={campaign}/>
      <div className='flex flex-col justify-between mt-4 w-full'>
          <h1 className='text-4xl text-center mt-4 mb-4'>Top Locations</h1>
            {/* @ts-ignore*/}
          <CompanyLocationChart idName="chart2" campaign={campaign?.id} />
          <h1 className='text-4xl text-center mt-4 mb-8'>Average Director Age</h1>
          {/* @ts-ignore*/}
          <DirectorAgeChart idName="chart1" campaign={campaign?.id} />
          <h1 className='text-4xl text-center mt-0 mb-8'>Cost Comparison</h1>
          {/* @ts-ignore*/}
          <CampaignCostChart idName="chart3" campaign={campaign?.id} />
     
      </div>
    </div>
  )
}

export default Campaign